{"version":3,"file":"js/325.5314757a.js","mappings":"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","sources":["webpack://yoome-front/./src/views/users/DecouvertProfilView.vue","webpack://yoome-front/./src/views/users/DecouvertProfilView.vue?1ec7"],"sourcesContent":["<template>\r\n\r\n    <section class=\"matches\">\r\n        <div v-for=\"match in matchs\">\r\n            <a :href=\"`${ipAddressFront}/conversation/${match.channel}`\">\r\n                <div>\r\n                    <img :src=\"`${url}${match.selfie}`\" alt=\"selfie\">\r\n                    <p>{{ match.firstname }}</p>\r\n                </div>\r\n            </a>\r\n\r\n        </div>\r\n    </section>\r\n\r\n    <div class=\"container\">\r\n        <h2>Découvrez des profils</h2>\r\n        <label class=\"file-upload\" v-if=\"!sansUser\" @click=\"opendesription\">\r\n\r\n            <div :style=\"`background-image:url('${url}${urlImage}')`\" class=\"file-upload\"></div>\r\n            <h1 class=\"textImage\">{{ nameImage }}, {{ age }} ans </h1>\r\n\r\n            <div v-if=\"!open\" class=\"description\"> {{ description }} </div>\r\n\r\n        </label>\r\n        <div v-else>\r\n            <div class=\"file-upload2\">\r\n                <img src=\"./../../assets/pictures/home/logo.png\" alt=\"\">\r\n                <h1 class=\"match\">Tous les profils ont été matchés ou il n’y a plus de profils à découvrir ! </h1>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"buttonRound\" v-if=\"!sansUser\">\r\n            <div class=\"round2 icon\" @click=\"suivantNo\">\r\n                <AkXSmall class=\"icon\" />\r\n            </div>\r\n            <div v-if=\"idButton == 0\" class=\"round\" @click=\"suivantYes\"> <img class=\"icon\"\r\n                    src=\"./../../assets/pictures/home/logo-m.png\" alt=\"\">\r\n            </div>\r\n            <div v-if=\"idButton == 1\" class=\"round chiffre\" @click=\"suivantYes\"> 2 </div>\r\n            <div v-if=\"idButton == 2\" class=\"round chiffre\" @click=\"suivantYes\"> 1 </div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport router from '@/router';\r\nimport { computed, onMounted, ref } from 'vue';\r\nimport { AkXSmall } from '@kalimahapps/vue-icons';\r\nimport store from '@/store';\r\nconst sansUser = ref(false)\r\nconst matchs = ref([]);\r\nconst user = computed(() => store.state.user || {});\r\nconst age = ref(null)\r\nconst nameImage = ref('')\r\nconst idUser = ref(0)\r\nconst idLiked = ref([])\r\nconst ipAddressFront = process.env.VUE_APP_IP_FRONT\r\nconst urlImage = ref('')\r\n\r\nconst url = `${process.env.VUE_APP_IP_ADDRESS}/uploads/`;\r\nconst nbId = ref(0)\r\nconst idButton = ref(0)\r\nconst description = ref('')\r\nconst open = ref(true)\r\n\r\nconst opendesription = () => {\r\n    open.value = !open.value\r\n\r\n}\r\n\r\nlet isClickable = true\r\nconst suivantYes = () => {\r\n    if (!isClickable) return;\r\n    open.value = true\r\n\r\n    if (!idLiked.value.includes(idUser.value)) {\r\n        fetchLikedID();\r\n        fetchLikedShowID();\r\n    }\r\n\r\n    fetchDecouverteProfil();\r\n    fetchLike();\r\n\r\n \r\n    isClickable = false;\r\n    navconv()\r\n\r\n    const intervalId = setInterval(() => {\r\n        if (idButton.value < 2) {\r\n            idButton.value++;\r\n        } else {\r\n            idButton.value = 0;\r\n            isClickable = true;\r\n           \r\n            clearInterval(intervalId);\r\n        }\r\n    }, 1000);\r\n};\r\n\r\n\r\nconst suivantNo = () => {\r\n    fetchDecouverteProfil()\r\n    open.value = true\r\n}\r\nonMounted(() => {\r\n    fetchLikedShowID()\r\n    fetchDecouverteProfil()\r\n    navconv()\r\n});\r\n\r\nconst navconv = async () => {\r\n    const options = {\r\n        method: 'GET',\r\n        headers: {\r\n            accept: 'application/json',\r\n        }\r\n    };\r\n\r\n    fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/matchs/listMatch/${user.value.id}`, options).then(handleFetch);\r\n\r\n    function handleFetch(response) {\r\n        if (response.ok) {\r\n            response.json()\r\n                .then(data => {\r\n\r\n\r\n                    data.forEach(listMatch => {\r\n                        matchs.value.push({\r\n                            firstname: listMatch.firstname,\r\n                            selfie: listMatch.selfie,\r\n                            channel: listMatch.id_channel,\r\n                        })\r\n                    });\r\n                })\r\n                .catch(error => console.error(error));\r\n        }\r\n        else {\r\n            console.error(response.statusText);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nconst profilsNonLiques = ref([]);\r\nconst fetchDecouverteProfil = async () => {\r\n    try {\r\n        const response = await fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/profiles/showProfil`, {\r\n            method: 'GET',\r\n        });\r\n\r\n        if (!response.ok) {\r\n            console.error(\"Erreur lors de la récupération des données.\");\r\n            return;\r\n        }\r\n        const result = await response.json();\r\n\r\n        // Filtre les profils pour n'afficher que ceux qui ne sont pas likés\r\n        profilsNonLiques.value = result.filter(profil => !idLiked.value.includes(profil.id_user));\r\n\r\n\r\n        if (profilsNonLiques.value.length === 0) {\r\n            console.log(\"Tous les profils ont été likés !\");\r\n            sansUser.value = true\r\n            return;\r\n        }\r\n\r\n        // Affiche le profil suivant parmi les non-likés\r\n        const profil = profilsNonLiques.value[nbId.value % profilsNonLiques.value.length];\r\n        urlImage.value = profil.selfie;\r\n        idUser.value = profil.id_user;\r\n        description.value = profil.description\r\n        nbId.value = (nbId.value + 1) % profilsNonLiques.value.length;\r\n\r\n\r\n\r\n\r\n        fetchUser();\r\n\r\n    } catch (error) {\r\n        console.error('Erreur lors du fetch showprofil :', error);\r\n    }\r\n};\r\n\r\nconst calculateAge = (birthdate) => {\r\n    const birthDate = new Date(birthdate);\r\n    const today = new Date();\r\n    let age = today.getFullYear() - birthDate.getFullYear();\r\n    const monthDiff = today.getMonth() - birthDate.getMonth();\r\n\r\n    // Ajuste l'âge si l'anniversaire n'est pas encore passé cette année\r\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\r\n        age--;\r\n    }\r\n\r\n    return age;\r\n};\r\n\r\nconst fetchUser = async () => {\r\n\r\n\r\n    try {\r\n        const response = await fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/users/listUser/${idUser.value}`, {\r\n            method: 'post',\r\n\r\n        })\r\n\r\n        if (!response.ok) {\r\n\r\n            console.log(error);\r\n\r\n            return;\r\n        }\r\n        const result = await response.json();\r\n\r\n\r\n\r\n        age.value = calculateAge(result[0].birthdate);\r\n        nameImage.value = result[0].firstname\r\n\r\n    } catch (error) {\r\n        console.error('Erreur lors du fetch user profilview :', error);\r\n    }\r\n}\r\n\r\nconst fetchLike = async () => {\r\n    const data = {\r\n        id_user_liker: user.value.id,\r\n        id_user_liked: idUser.value\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/likes/addLikes`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(data),\r\n            headers: {\r\n                'Accept': 'application/json, text/plain, */*',\r\n                'Content-Type': 'application/json',\r\n            },\r\n        });\r\n\r\n        await response.json();\r\n\r\n\r\n\r\n    } catch (err) {\r\n        console.error('Error during fetch like:', err);\r\n    }\r\n}\r\n\r\nconst fetchLikedID = async () => {\r\n    const data = {\r\n        id_user: user.value.id,\r\n        id_liked: idUser.value\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/profiles/modifyProfil`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(data),\r\n            headers: {\r\n                'Accept': 'application/json, text/plain, */*',\r\n                'Content-Type': 'application/json',\r\n            },\r\n        });\r\n\r\n        // Vérifie si le statut de la réponse indique une erreur\r\n        if (!response.ok) {\r\n            throw new Error(`HTTP error! Status: ${response.status}`);\r\n        }\r\n\r\n        const result = await response.json();\r\n        console.log('Profil modifié avec succès:', result); // Traiter le retour si nécessaire\r\n\r\n    } catch (err) {\r\n        console.error('Error during fetch like id:', err);\r\n    }\r\n};\r\n\r\nconst fetchLikedShowID = async () => {\r\n    try {\r\n        const response = await fetch(`${process.env.VUE_APP_IP_ADDRESS}/api/users/listUser/${user.value.id}`, {\r\n            method: 'post',\r\n\r\n        })\r\n\r\n        if (!response.ok) {\r\n\r\n            console.log(error);\r\n\r\n            return;\r\n        }\r\n        const result = await response.json();\r\n\r\n\r\n\r\n\r\n        idLiked.value = result[0].id_liked\r\n\r\n\r\n\r\n\r\n    } catch (error) {\r\n        console.error('Erreur lors du fetch user profilview :', error);\r\n    }\r\n};\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"@/style/variablecouleur.scss\";\r\n\r\n.container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    background-color: white;\r\n\r\n}\r\n\r\n.description {\r\n    padding: 5px 10px;\r\n    color: white;\r\n}\r\n\r\n.chiffre {\r\n    font-size: xx-large;\r\n    opacity: 0.5;\r\n\r\n}\r\n\r\n.matches {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 100px;\r\n    background-color: #FCE2E2;\r\n\r\n    a {\r\n        text-decoration: none;\r\n        color: black;\r\n\r\n        div {\r\n            margin: 0 5px 0 5px;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n\r\n            img {\r\n                display: flex;\r\n                justify-content: center;\r\n                border: 1px solid $primary;\r\n                width: 50px;\r\n                height: 50px;\r\n                border-radius: 50%;\r\n            }\r\n\r\n            p {\r\n                font-size: 0.8em;\r\n            }\r\n        }\r\n\r\n        div:nth-of-type(1) {\r\n            margin-left: 15px;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nh1 {\r\n    font-weight: 300;\r\n    padding: 10px;\r\n    padding-left: 40px;\r\n    font-size: medium;\r\n    text-align: left\r\n}\r\n\r\n.buttonRound {\r\n    margin: 20px;\r\n    gap: 80px;\r\n    display: flex;\r\n    flex-direction: row;\r\n}\r\n\r\n.round {\r\n    height: 90px;\r\n    width: 90px;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n    align-content: center;\r\n    border-radius: 99999%;\r\n    background-color: $white;\r\n\r\n\r\n    img {\r\n        height: 40%;\r\n\r\n    }\r\n}\r\n\r\n.round2 {\r\n    height: 90px;\r\n    width: 90px;\r\n    align-items: center;\r\n    align-content: center;\r\n    border-radius: 99999%;\r\n    background-color: rgb(202, 202, 202);\r\n\r\n    .icon {\r\n        opacity: 0.5;\r\n        width: 85%;\r\n        height: 80%;\r\n    }\r\n}\r\n\r\n.textImage {\r\n    color: whitesmoke;\r\n\r\n}\r\n\r\nh2 {\r\n    margin: 30px;\r\n}\r\n\r\n.file-upload {\r\n    width: 350px;\r\n    height: 450px;\r\n    border: 1px solid rgba(249, 112, 104, 1);\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: $primary;\r\n    background-position: center;\r\n    background-size: cover;\r\n    align-items: left;\r\n    justify-content: left;\r\n    border-radius: 35px;\r\n    margin: auto;\r\n\r\n}\r\n\r\n.file-upload2 {\r\n    width: 350px;\r\n    height: 450px;\r\n    border: 1px solid rgba(249, 112, 104, 1);\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: $primary;\r\n    background-position: center;\r\n    background-size: cover;\r\n    align-items: left;\r\n    justify-content: left;\r\n    border-radius: 35px;\r\n    margin: auto;\r\n    padding-top: 70px;\r\n    margin-bottom: 80px;\r\n\r\n    img {\r\n        background-color: rgb(0, 0, 0, 0.2);\r\n        padding-bottom: 20px;\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n}\r\n\r\n.file-upload input[type=\"file\"] {\r\n    display: none;\r\n}\r\n\r\n.uploadPicture {\r\n    width: 60px;\r\n    height: 60px;\r\n}\r\n</style>","import script from \"./DecouvertProfilView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DecouvertProfilView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./DecouvertProfilView.vue?vue&type=style&index=0&id=3ffc407c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3ffc407c\"]])\n\nexport default __exports__"],"names":["sansUser","matchs","user","store","state","age","nameImage","idUser","idLiked","ipAddressFront","urlImage","url","nbId","idButton","description","open","opendesription","value","isClickable","suivantYes","includes","fetchLikedID","fetchLikedShowID","fetchDecouverteProfil","fetchLike","navconv","intervalId","setInterval","clearInterval","suivantNo","async","options","method","headers","accept","handleFetch","response","ok","json","then","data","forEach","listMatch","push","firstname","selfie","channel","id_channel","catch","error","console","statusText","fetch","id","profilsNonLiques","result","filter","profil","id_user","length","log","fetchUser","calculateAge","birthdate","birthDate","Date","today","getFullYear","monthDiff","getMonth","getDate","id_user_liker","id_user_liked","body","JSON","stringify","err","id_liked","Error","status","__exports__"],"sourceRoot":""}