"use strict";(self["webpackChunkyoome_front"]=self["webpackChunkyoome_front"]||[]).push([[325],{325:function(e,l,t){t.r(l),t.d(l,{default:function(){return E}});var o=t(641),r=t(953),s=t(33),a=t(425),n=t(319),i=(t(8),t(591)),c=t(638);const u={class:"matches"},d=["href"],v=["src"],f={class:"container"},h={class:"textImage"},p={key:0,class:"description"},k={key:1},y={key:2,class:"buttonRound"};var g={__name:"DecouvertProfilView",setup(e){const l=(0,r.KR)(!1),t=(0,r.KR)([]),g=(0,o.EW)((()=>c.A.state.user||{})),m=(0,r.KR)(null),w=(0,r.KR)(""),E=(0,r.KR)(0),_=(0,r.KR)([]),C="http://10.0.0.170:8080",K=(0,r.KR)(""),L="http://10.0.0.170:3000/uploads/",R=(0,r.KR)(0),T=(0,r.KR)(0),j=(0,r.KR)(""),b=(0,r.KR)(!0),X=()=>{b.value=!b.value};let $=!0;const P=()=>{if(!$)return;b.value=!0,_.value.includes(E.value)||(O(),J()),F(),S(),$=!1,x();const e=setInterval((()=>{T.value<2?T.value++:(T.value=0,$=!0,clearInterval(e))}),1e3)},D=()=>{F(),b.value=!0};(0,o.sV)((()=>{J(),F(),x()}));const x=async()=>{const e={method:"GET",headers:{accept:"application/json"}};function l(e){e.ok?e.json().then((e=>{e.forEach((e=>{t.value.push({firstname:e.firstname,selfie:e.selfie,channel:e.id_channel})}))})).catch((e=>console.error(e))):console.error(e.statusText)}fetch(`http://10.0.0.170:3000/api/matchs/listMatch/${g.value.id}`,e).then(l)},A=(0,r.KR)([]),F=async()=>{try{const e=await fetch("http://10.0.0.170:3000/api/profiles/showProfil",{method:"GET"});if(!e.ok)return void console.error("Erreur lors de la récupération des données.");const t=await e.json();if(A.value=t.filter((e=>!_.value.includes(e.id_user))),0===A.value.length)return console.log("Tous les profils ont été likés !"),void(l.value=!0);const o=A.value[R.value%A.value.length];K.value=o.selfie,E.value=o.id_user,j.value=o.description,R.value=(R.value+1)%A.value.length,Q()}catch(error){console.error("Erreur lors du fetch showprofil :",error)}},I=e=>{const l=new Date(e),t=new Date;let o=t.getFullYear()-l.getFullYear();const r=t.getMonth()-l.getMonth();return(r<0||0===r&&t.getDate()<l.getDate())&&o--,o},Q=async()=>{try{const e=await fetch(`http://10.0.0.170:3000/api/users/listUser/${E.value}`,{method:"post"});if(!e.ok)return void console.log(error);const l=await e.json();m.value=I(l[0].birthdate),w.value=l[0].firstname}catch(error){console.error("Erreur lors du fetch user profilview :",error)}},S=async()=>{const e={id_user_liker:g.value.id,id_user_liked:E.value};try{const l=await fetch("http://10.0.0.170:3000/api/likes/addLikes",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});await l.json()}catch(l){console.error("Error during fetch like:",l)}},O=async()=>{const e={id_user:g.value.id,id_liked:E.value};try{const l=await fetch("http://10.0.0.170:3000/api/profiles/modifyProfil",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});if(!l.ok)throw new Error(`HTTP error! Status: ${l.status}`);const t=await l.json();console.log("Profil modifié avec succès:",t)}catch(l){console.error("Error during fetch like id:",l)}},J=async()=>{try{const e=await fetch(`http://10.0.0.170:3000/api/users/listUser/${g.value.id}`,{method:"post"});if(!e.ok)return void console.log(error);const l=await e.json();_.value=l[0].id_liked}catch(error){console.error("Erreur lors du fetch user profilview :",error)}};return(e,c)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("section",u,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.value,(e=>((0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("a",{href:`${(0,r.R1)(C)}/conversation/${e.channel}`},[(0,o.Lk)("div",null,[(0,o.Lk)("img",{src:`${L}${e.selfie}`,alt:"selfie"},null,8,v),(0,o.Lk)("p",null,(0,s.v_)(e.firstname),1)])],8,d)])))),256))]),(0,o.Lk)("div",f,[c[2]||(c[2]=(0,o.Lk)("h2",null,"Découvrez des profils",-1)),l.value?((0,o.uX)(),(0,o.CE)("div",k,c[0]||(c[0]=[(0,o.Lk)("div",{class:"file-upload2"},[(0,o.Lk)("img",{src:a,alt:""}),(0,o.Lk)("h1",{class:"match"},"Tous les profils ont été matchés ou il n’y a plus de profils à découvrir ! ")],-1)]))):((0,o.uX)(),(0,o.CE)("label",{key:0,class:"file-upload",onClick:X},[(0,o.Lk)("div",{style:(0,s.Tr)(`background-image:url('${L}${K.value}')`),class:"file-upload"},null,4),(0,o.Lk)("h1",h,(0,s.v_)(w.value)+", "+(0,s.v_)(m.value)+" ans ",1),b.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",p,(0,s.v_)(j.value),1))])),l.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("div",{class:"round2 icon",onClick:D},[(0,o.bF)((0,r.R1)(i.AKJ),{class:"icon"})]),0==T.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"round",onClick:P},c[1]||(c[1]=[(0,o.Lk)("img",{class:"icon",src:n,alt:""},null,-1)]))):(0,o.Q3)("",!0),1==T.value?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"round chiffre",onClick:P}," 2 ")):(0,o.Q3)("",!0),2==T.value?((0,o.uX)(),(0,o.CE)("div",{key:2,class:"round chiffre",onClick:P}," 1 ")):(0,o.Q3)("",!0)]))])],64))}},m=t(262);const w=(0,m.A)(g,[["__scopeId","data-v-3ffc407c"]]);var E=w},425:function(e,l,t){e.exports=t.p+"img/logo.a6eb749c.png"}}]);
//# sourceMappingURL=325.5314757a.js.map